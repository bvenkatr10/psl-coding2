"0","pcr_model <- function(test.id, myData, X, Y) {"
"0","  # pcr model"
"0","  mypcr = pcr(Y ~ ., data= myData[-test.id, ], validation=""CV"")"
"0","  CVerr = RMSEP(mypcr)$val[1, , ]"
"0","  adjCVerr = RMSEP(mypcr)$val[2, , ]"
"0","  best.ncomp = which.min(CVerr) - 1"
"0","  if (best.ncomp==0) {"
"0","    Ytest.pred = mean(myData$Y[-test.id])"
"0","  } else {"
"0","    Ytest.pred = predict(mypcr, myData[test.id,], ncomp=best.ncomp)"
"0","  }"
"0","  "
"0","  mean_out = mean((Ytest.pred - myData$Y[test.id])^2)"
"0","  return (mean_out)"
"0","}"
